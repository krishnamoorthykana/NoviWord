{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/index.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/* eslint-disable prettier/prettier */\r\n/* eslint-disable no-undef */\r\n \r\nlet speechFlag = false;\r\nlet popup=null;\r\nlet loader=true;\r\n console.log(\"testing\");\r\nOffice.onReady(async function (info) {\r\n  displayStartingMessage(\"Hi! I'm NoviPilot, your personal Copilot agent. I can help you create documents, modify content, and insert useful information seamlessly. How can I assist you today?\");\r\n  let directLine1 = await initializeDirectLine();\r\nif (info.host === Office.HostType.Word) {\r\n \r\ndocument.getElementById(\"sendButton\").onclick = async function () {\r\n  const question = document.getElementById(\"userInput\").value;\r\n  if (question) {\r\n    //document.getElementById(\"headerId\").style.display = \"none\";\r\n    displayChatMessage(question, '', \"User\",directLine1);\r\n    await getBotResponse(directLine1, question);\r\n  }\r\n};\r\n \r\ndocument.getElementById(\"userInput\").addEventListener(\"keydown\", async function (event) {\r\n  if (event.key === \"Enter\") {\r\n    // Check if Enter key is pressed\r\n    event.preventDefault(); // Prevents the default behavior (like submitting a form)\r\n \r\n    const question = document.getElementById(\"userInput\").value;\r\n    if (question) {\r\n      //document.getElementById(\"headerId\").style.display = \"none\";\r\n      displayChatMessage(question, '', \"User\",directLine1);\r\n      await getBotResponse(directLine1, question);\r\n     \r\n  }\r\n}});\r\n \r\n// Handle the Insert button click\r\ndocument.getElementById(\"insertButton\").onclick = async function () {\r\n  const response = document.getElementById(\"chatWindow\").lastChild\r\n    ? document.getElementById(\"chatWindow\").lastChild.innerText\r\n    : \"\";\r\n  if (response) {\r\n    await insertResponseIntoDocument(response);\r\n  }\r\n};\r\n \r\ndocument.getElementById('startSpeechButton').addEventListener('click', function () {\r\n  // Open a pop-up window to handle the speech\r\n  if(speechFlag){\r\n    mic.classList.toggle(\"recording\");\r\n    speechFlag=false;\r\n    try{\r\n      popup.close();\r\n    }\r\n    catch{\r\n      console.log(\"popup closed\")\r\n    }\r\n   \r\n  }\r\n  else{\r\n  mic.classList.toggle(\"recording\");\r\n  popup = window.open(\r\n    'speech.html',\r\n    'SpeechRecognition',\r\n    'width=1,height=1'\r\n  );\r\n  speechFlag = true;\r\n  // Listen for messages from the pop-up window\r\n  window.addEventListener(\"message\", async function eventHandler(event){\r\n      if (event.origin !== window.location.origin) return; // Security check\r\n \r\n      // Get the recognized text from the pop-up\r\n      transcript = event.data;\r\n \r\n      // Insert recognized text into user input\r\n      console.log(transcript);\r\n      if(transcript===\"NoSpeech\"){\r\n        popup.close();\r\n        speechFlag=false;\r\n        mic.classList.toggle(\"recording\");\r\n        window.removeEventListener(\"message\", eventHandler);\r\n      }\r\n      else{\r\n      document.getElementById(\"userInput\").value = transcript;\r\n      var question = document.getElementById(\"userInput\").value  ;\r\n    if (question) {\r\n        document.getElementById(\"userInput\").value =\"\";\r\n        displayChatMessage(question, '', \"User\");\r\n        const micButton=document.getElementById(\"startSpeechButton\")//disable mic\r\n        micButton.disabled=true;\r\n        await getBotResponse(directLine1, question);\r\n      }\r\n      popup.close();\r\n     \r\n      mic.classList.toggle(\"recording\");\r\n      window.removeEventListener(\"message\", eventHandler);\r\n  }}, { once: true });\r\n \r\n}\r\n});\r\n \r\n}\r\n});\r\n \r\nfunction displayStartingMessage(starter) {\r\n  chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">${starter}</div>`;\r\n}\r\n \r\n \r\n// Display user question and bot response in chat window\r\nasync function displayChatMessage(question, response, role,directLine) {\r\n  const chatWindow = document.getElementById(\"chatWindow\");\r\n  console.log(\"displayfunction called\");\r\n \r\n  // Check if response is valid and if attachments exist\r\n  // eslint-disable-next-line no-constant-condition\r\n  if (response && response.attachments && response.attachments.length > 0 && false ) {\r\n    response.attachments.forEach((attachment) => {\r\n      // Check if attachment content has 'buttons' and 'signin' type\r\n      if (attachment.content && attachment.content.buttons && attachment.content.buttons.length > 0) {\r\n        attachment.content.buttons.forEach((button) => {\r\n          if (button.type === \"signin\") {\r\n            // Create a sign-in button\r\n            const signinButton = document.createElement(\"button\");\r\n            signinButton.innerText = button.title || \"Sign In\"; // Default title to \"Sign In\"\r\n            signinButton.classList.add(\"ms-Button\", \"ms-Button--primary\");\r\n \r\n            // Open the sign-in URL when the button is clicked\r\n            signinButton.onclick = () => {\r\n              window.open(button.value, \"_blank\"); // Open the sign-in URL in a new tab\r\n            };\r\n \r\n            // Display the bot's message\r\n            chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">${attachment.content.text}</div>`;\r\n            chatWindow.appendChild(signinButton); // Add the button after the message\r\n          }\r\n        });\r\n      }\r\n    });\r\n  } else {\r\n    // Regular message display if no attachments\r\n    if (role === \"bot\") {\r\n      if(response.speak===\"Generate\"){\r\n \r\n        insertResponseIntoDocument(response.text);\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">SOW content generated in document</div>`;\r\n        if(speechFlag){\r\n          ensureVoicesLoaded(() => {\r\n            speakText(\"S.O.W. content generated in document\");\r\n        });\r\n       \r\n        //speechFlag = false;  \r\n        }\r\n      }else if(response.speak===\"Table\"){\r\n \r\n        insertResponseIntoDocumentAtCursor(response.text, \"end\");\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">Table has been generated in document</div>`;      \r\n        if(speechFlag){\r\n          ensureVoicesLoaded(() => {\r\n            speakText(\"Table has been generated in document\");\r\n        });\r\n       \r\n        //speechFlag = false;  \r\n        }\r\n      }\r\n      else if(response.speak===\"TableReplace\"){\r\n        let statusflag=false;\r\n        statusflag=await insertResponseIntoDocumentAtCursor(response.text,\"replace\");\r\n        console.log(statusflag);\r\n        if(statusflag){\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">Table has been generated in document</div>`;      \r\n        if(speechFlag){\r\n          ensureVoicesLoaded(() => {\r\n            speakText(\"Table has been generated in document\");\r\n        });\r\n       \r\n        //speechFlag = false;  \r\n        }}\r\n        else{\r\n          chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">No table is selected in the document</div>`;      \r\n        if(speechFlag){\r\n          ensureVoicesLoaded(() => {\r\n            speakText(\"No table is selected in the document\");\r\n        });\r\n       \r\n        //speechFlag = false;  \r\n        }\r\n        }\r\n      }\r\n      else if(response.speak===\"Replace\"){\r\n        splitText=response.text\r\n        textArray=splitText.split(\"|\");\r\n        replaceText(textArray[0],textArray[1]);\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">Replaced ${textArray[0]} with ${textArray[1]} </div>`;      \r\n        if(speechFlag){\r\n          ensureVoicesLoaded(() => {\r\n            speakText(`Replaced ${textArray[0]} with ${textArray[1]}`);\r\n        });\r\n       \r\n        //speechFlag = false;  \r\n        }\r\n      }\r\n      else if(response.speak===\"Selected\"){\r\n        if(response.text===\"Table\"){\r\n          console.log(\"fetching selected table\")\r\n          getSelectedTable(directLine);\r\n        }\r\n        else{\r\n        console.log(\"fetching selected data\")\r\n        getSelectedText(directLine);  \r\n        }\r\n      }\r\n      else if(response.speak===\"paragraph\"){\r\n        setSelectedText(response.text);\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">Requested changes have been made in the document</div>`;  \r\n        if(speechFlag){\r\n          ensureVoicesLoaded(() => {\r\n            speakText(\"Requested changes have been made in the document\");\r\n        });\r\n       \r\n        //speechFlag = false;  \r\n        }\r\n      }\r\n      else if(response.speak===\"interim\"){\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">${response.text}</div>`;\r\n        console.log(\"Calling loading function\");\r\n        displayLoading();\r\n        if(speechFlag){\r\n          ensureVoicesLoaded(async () => {\r\n            await speakText(response.text);\r\n            speechFlag=true;\r\n        });\r\n       \r\n        }      \r\n      }\r\n      else if(response.speak===\"interimSpeak\"){\r\n        console.log(\"Calling loading function\");\r\n        displayLoading();\r\n        if(speechFlag){\r\n          ensureVoicesLoaded(async () => {\r\n            await speakText(response.text);\r\n            speechFlag=true;\r\n        });\r\n       \r\n        }      \r\n      }\r\n      else if(response.speak===\"interimFinal\"){\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">${response.text}</div>`;\r\n        if(speechFlag){\r\n          ensureVoicesLoaded(async () => {\r\n            speakText(response.text);\r\n           \r\n        });\r\n       \r\n        }      \r\n      }\r\n   \r\n      else if(response.text){\r\n        chatWindow.innerHTML += `<div class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div class=\"message bot\">${response.text}</div>`;\r\n        document.getElementById(\"insertButton\").style.display = \"block\";\r\n        if(speechFlag){\r\n          console.log(\"speaking bot message\");\r\n          ensureVoicesLoaded(() => {\r\n            speakText(response.text);\r\n        });\r\n       \r\n        //speechFlag = false;  \r\n        }      \r\n      }\r\n     \r\n    }\r\n    else {\r\n      if(question){\r\n        document.getElementById(\"insertButton\").style.display = \"none\";\r\n        chatWindow.innerHTML += `<div class=\"user-wrapper\">You</div><div class=\"message user\">${question}</div>`;      }\r\n     \r\n    }\r\n  }\r\n  scrollToBottom();\r\n  // Clear the input field\r\n  document.getElementById(\"userInput\").value = \"\";\r\n}\r\n \r\n// Function to insert the response into the Word document\r\nasync function insertResponseIntoDocument(response) {\r\n  await Word.run(async (context) => {\r\n    const body = context.document.body;\r\n    body.insertHtml(response, Word.InsertLocation.end);\r\n    await context.sync();\r\n  });\r\n}\r\n \r\nasync function insertResponseIntoDocumentAtCursor(response, insertAt) {\r\n  if (insertAt === \"end\") {\r\n    console.log(\"end of doc table\");\r\n    return await Word.run(async (context) => {\r\n      const body = context.document.body;\r\n      body.insertHtml(response, Word.InsertLocation.end);\r\n      await context.sync();\r\n      return true;\r\n    });\r\n  } else {\r\n    return await Word.run(async (context) => {\r\n      const selection = context.document.getSelection();\r\n      selection.load(\"parentTable\");\r\n      await context.sync();\r\n \r\n      if (!selection.parentTable) {\r\n          console.log(\"âŒ No table selected.\");\r\n          return false;\r\n      }\r\n \r\n      const table = selection.parentTable;\r\n      const tableRange = table.getRange(Word.RangeLocation.entire); // Capture range before deletion\r\n      tableRange.load();\r\n      await context.sync();\r\n \r\n      console.log(\"Table found. Deleting...\");\r\n     \r\n      // Insert a placeholder before deleting (to keep a valid reference)\r\n      const placeholder = tableRange.insertText(\" \", Word.InsertLocation.before);\r\n      placeholder.load(\"text, address\"); // Load placeholder info\r\n      await context.sync();\r\n \r\n      table.delete(); // Delete the table\r\n      await context.sync();\r\n      console.log(\"Table deleted.\");\r\n \r\n      console.log(\"Inserting new table...\");\r\n      placeholder.insertHtml(response, Word.InsertLocation.replace); // Insert new content\r\n      await context.sync();\r\n \r\n      console.log(\"New table inserted.\");\r\n      return true;\r\n  });\r\n  }}\r\n \r\nconst initializeDirectLine = async function () {\r\n  try {\r\n    const response = await fetch(\r\n      \"https://148a369decc3eeda85b913c1e80b9a.da.environment.api.powerplatform.com/powervirtualagents/botsbyschema/cra27_agent123/directline/token?api-version=2022-03-01-preview\"\r\n    );\r\n    const data = await response.json();\r\n   \r\n    const directLine = new window.DirectLine.DirectLine({ token: data.token });\r\n   \r\n \r\n    if (!directLine || !directLine.activity$) {\r\n      throw new Error(\"DirectLine instance failed to initialize\");\r\n    }\r\n \r\n    directLine\r\n      .postActivity({\r\n        from: { id: \"10\", name: \"User\" },\r\n        type: \"message\",\r\n        text: \"Hi\",\r\n      })\r\n      .subscribe(\r\n        (id) => console.log(\"Message sent with ID:\", id),\r\n        (error) => console.error(\"Error sending message:\", error)\r\n      );\r\n \r\n    directLine.activity$.subscribe((activity) => {\r\n      console.log(\"Testing activity on send: \", activity);\r\n      console.log(\"Role\", activity.from.role);\r\n \r\n      if (activity.type === \"message\" && activity.from.id !== \"10\" && !activity.recipient) {\r\n        console.log(\"Bot Response: \", activity.text);\r\n        if(response.speak!==\"Selected\" ){\r\n          try{\r\n            document.getElementById(\"loader-container\").remove();\r\n            document.getElementById(\"loader\").remove();\r\n          }catch{\r\n            console.log(\"could not find the element\");\r\n          }\r\n          loader=true;\r\n      }else{\r\n        loader=false;\r\n      }\r\n        displayChatMessage(false, activity, activity.from.role,directLine);\r\n      }\r\n    });\r\n    return directLine;\r\n  } catch (error) {\r\n    console.error(\"Error initializing DirectLine:\", error);\r\n  }\r\n};\r\n \r\nconst getBotResponse = async function (directLine, question) {\r\n  // call loading function\r\n  console.log(\"Calling loading function\");\r\n  displayLoading();\r\n  console.log(\"User:\",question);\r\n  directLine\r\n    .postActivity({\r\n      from: { id: \"10\", name: \"User\" },\r\n      type: \"message\",\r\n      text: question,\r\n    })\r\n    .subscribe(             // calls the subscription already created in InitializeDirectline method\r\n      (id) => console.log(\"Message sent with ID:\", id),\r\n      (error) => console.error(\"Error sending message:\", error)\r\n    );\r\n \r\n}\r\nfunction scrollToBottom() {\r\n  const chatWindow = document.getElementById(\"chatWindow\");\r\n  setTimeout(() => {\r\n    chatWindow.scrollTop = chatWindow.scrollHeight;\r\n  }, 100); // Timeout ensures scroll happens after the new message is rendered\r\n}\r\n \r\nasync function replaceText(oldText, newText) {\r\n  await Word.run(async (context) => {\r\n      let results = context.document.body.search(oldText, { matchCase: false });\r\n      results.load(\"items\");\r\n      await context.sync();\r\n      console.log(\"Results found:\", results.items.length);\r\n      for (let i = results.items.length - 1; i >= 0; i--) {\r\n          let item = results.items[i];\r\n          console.log(\"Replacing:\", item.text);\r\n          item.insertText(newText, Word.InsertLocation.replace);\r\n      }\r\n      await context.sync();\r\n      console.log(\"ll instances replaced successfully.\");\r\n  });\r\n}\r\n \r\nasync function getSelectedText(directLine) {\r\n  await Word.run(async (context) => {\r\n    let range = context.document.getSelection();\r\n    range.load(\"text\");\r\n    await context.sync();\r\n    SelText=range.text;\r\n    await getBotResponse(directLine, SelText);\r\n});\r\n \r\n}\r\n \r\nasync function getSelectedTable(directLine) {\r\n \r\n  await Word.run(async (context) => {\r\n    const selection = context.document.getSelection();\r\n    selection.load(\"parentTable\");\r\n    await context.sync();\r\n    if (selection.parentTable) {\r\n        const table = selection.parentTable;\r\n        table.load(\"values\"); // Get table content as a 2D array\r\n       \r\n        await context.sync();\r\n \r\n        const tableValues = table.values; // Array of rows with cell content\r\n \r\n        let plainTextTable = \"\";\r\n        tableValues.forEach(row => {\r\n            plainTextTable += row.join(\" | \") + \"\\n\"; // Join cells with \"|\"\r\n        });\r\n \r\n        console.log(plainTextTable);\r\n        await getBotResponse(directLine, plainTextTable);\r\n         // Output the extracted table as plain text\r\n    } else {\r\n        console.log(\"No table selected by user.\");\r\n       \r\n    }\r\n});\r\n \r\n \r\n}\r\n \r\nasync function setSelectedText(response) {\r\n  await Word.run(async (context) => {\r\n    const selection = context.document.getSelection();\r\n    selection.insertText(response, Word.InsertLocation.replace);\r\n    await context.sync();\r\n  });\r\n}\r\n \r\nasync function speakText(text) {\r\n  console.log(\"Testing Text to Speech\");\r\n \r\n  let voices = window.speechSynthesis.getVoices();\r\n  console.log(\"Voices:\", voices);\r\n \r\n  let femaleVoice = voices.find(voice =>\r\n    voice.name.includes(\"Female\") ||\r\n    voice.name.includes(\"Google UK English Female\") ||\r\n    voice.name.includes(\"Microsoft Zira\") ||\r\n    voice.name.includes(\"Samantha\")\r\n  );\r\n \r\n  console.log(\"Set voice:\", femaleVoice);\r\n \r\n  const speech = new SpeechSynthesisUtterance(text);\r\n \r\n  if (femaleVoice) {\r\n    speech.voice = femaleVoice;\r\n  } else {\r\n    console.warn(\"Female voice not found. Using default voice.\");\r\n  }\r\n \r\n  return new Promise((resolve) => {\r\n    speech.onend = () => {\r\n      console.log(\"Speech has finished.\");\r\n      speechFlag=false;\r\n      // enable mic\r\n      const micButton=document.getElementById(\"startSpeechButton\")//disable mic\r\n      micButton.disabled=false;\r\n      console.log(\"mic enabled\");\r\n      resolve(true);\r\n    };\r\n \r\n    speech.onerror = (event) => {\r\n      console.error(\"Speech error:\", event.error);\r\n      speechFlag=false;\r\n      // enable mic\r\n      const micButton=document.getElementById(\"startSpeechButton\")//disable mic\r\n      micButton.disabled=false;\r\n      console.log(\"mic enabled\");\r\n      resolve(false);\r\n    };\r\n \r\n    window.speechSynthesis.speak(speech);\r\n  });\r\n}\r\n \r\n \r\n// Load voices properly before calling the function\r\nfunction ensureVoicesLoaded(callback) {\r\n  let voices = window.speechSynthesis.getVoices();\r\n \r\n  if (voices.length > 0) {\r\n      callback();\r\n  } else {\r\n      window.speechSynthesis.onvoiceschanged = callback;\r\n  }\r\n}\r\n \r\n \r\nfunction displayLoading(){\r\n  if(loader){\r\n    let loadingElement = document.getElementById(\"chatWindow\");\r\n    let loadingDots = [ \".\", \"..\", \"...\"];\r\n    let dotIndex = 1;\r\n    loadingElement.innerHTML += `<div id=\"loader-container\" class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div id = \"loader\" class=\"message bot\">.</div>`;\r\n   \r\n    let loader = document.getElementById(\"loader\");\r\n    setInterval(() => {\r\n      loader.innerText =loadingDots[dotIndex];\r\n        dotIndex = (dotIndex + 1) % loadingDots.length;\r\n    }, 500);\r\n }\r\n}\r\n ","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/copilot.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Word Chatbot Add-in</title> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/botframework-directlinejs@latest/dist/directline.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header class=\\\"ms-welcome__header\\\"> <div id=\\\"headerId\\\"> <img class=\\\"header-img\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Word Chatbot\\\" title=\\\"Word Chatbot\\\"/> <h3>Smart chat for smarter documents!</h3> </div> </header> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\"> <div class=\\\"chat-window-main\\\"> <div class=\\\"chat-container\\\"> <div id=\\\"chatWindow\\\" class=\\\"chat-window\\\"></div> </div> </div> <div class=\\\"input-container\\\"> <input type=\\\"text\\\" id=\\\"userInput\\\" class=\\\"input-field\\\" placeholder=\\\"Ask a question\\\"/> <button id=\\\"sendButton\\\" class=\\\"icon-button\\\"> <svg aria-hidden=\\\"true\\\" height=\\\"2em\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"2em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M2.18 2.11a.5.5 0 0 1 .54-.06l15 7.5a.5.5 0 0 1 0 .9l-15 7.5a.5.5 0 0 1-.7-.58L3.98 10 2.02 2.63a.5.5 0 0 1 .16-.52Zm2.7 8.39-1.61 6.06L16.38 10 3.27 3.44 4.88 9.5h6.62a.5.5 0 1 1 0 1H4.88Z\\\" fill=\\\"#000000\\\"></path></svg> </button> <button id=\\\"startSpeechButton\\\" class=\\\"icon-button\\\"> <svg id=\\\"mic\\\" class=\\\"mic\\\" width=\\\"30px\\\" height=\\\"30px\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"> <path d=\\\"M20 12V13C20 17.4183 16.4183 21 12 21C7.58172 21 4 17.4183 4 13V12M12 17C9.79086 17 8 15.2091 8 13V7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7V13C16 15.2091 14.2091 17 12 17Z\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/> </svg> </button> </div> <button id=\\\"insertButton\\\" class=\\\"ms-Button ms-Button--hero\\\" style=\\\"display:none\\\">Insert</button> </main> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","t","r","n","defineProperty","value","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","v","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","speechFlag","popup","loader","displayChatMessage","_x4","_x5","_x6","_x7","_displayChatMessage","_callee11","question","response","role","directLine","chatWindow","statusflag","_context11","getElementById","console","log","attachments","speak","insertResponseIntoDocument","text","innerHTML","ensureVoicesLoaded","speakText","insertResponseIntoDocumentAtCursor","splitText","textArray","split","replaceText","concat","getSelectedTable","getSelectedText","setSelectedText","displayLoading","_callee8","_context8","_callee9","_context9","_callee10","_context10","style","display","scrollToBottom","_x8","_insertResponseIntoDocument","_callee13","_context13","Word","run","_ref10","_callee12","context","_context12","body","insertHtml","InsertLocation","end","sync","_x19","_x9","_x10","_insertResponseIntoDocumentAtCursor","_callee16","insertAt","_context16","_ref11","_callee14","_context14","_x20","_ref12","_callee15","selection","table","tableRange","placeholder","_context15","getSelection","load","parentTable","getRange","RangeLocation","entire","insertText","before","delete","_x21","Office","onReady","_ref","_callee5","info","directLine1","_context5","initializeDirectLine","host","HostType","onclick","_callee","_context","getBotResponse","addEventListener","_ref3","_callee2","event","_context2","key","preventDefault","_x2","_callee3","_context3","lastChild","innerText","mic","classList","toggle","close","_unused","open","_eventHandler","_callee4","_context4","origin","transcript","data","removeEventListener","eventHandler","disabled","_x3","once","_x","_ref5","_callee6","_context6","fetch","json","DirectLine","token","activity$","postActivity","from","id","subscribe","error","activity","recipient","remove","_unused2","t0","_ref6","_callee7","_context7","_x11","_x12","setTimeout","scrollTop","scrollHeight","_x13","_x14","_replaceText","_callee18","oldText","newText","_context18","_ref13","_callee17","results","item","_context17","search","matchCase","items","_x22","_x15","_getSelectedText","_callee20","_context20","_ref14","_callee19","range","_context19","SelText","_x23","_x16","_getSelectedTable","_callee22","_context22","_ref15","_callee21","tableValues","plainTextTable","_context21","row","join","_x24","_x17","_setSelectedText","_callee24","_context24","_ref16","_callee23","_context23","_x25","_x18","_speakText","_callee25","voices","femaleVoice","speech","_context25","speechSynthesis","getVoices","find","voice","includes","SpeechSynthesisUtterance","warn","onend","onerror","callback","onvoiceschanged","loadingElement","loadingDots","dotIndex","setInterval","URL"],"sourceRoot":""}