{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/Constants.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/index.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","export const welcomeMsg =\r\n  \"Hi! I'm NoviPilot, your Word assistant bot. I can help you create documents, modify content, and insert useful information seamlessly. How can I assist you today?\";\r\nexport const tableMsg = \"Table has been generated in document\";\r\nexport const sowMsg = \"S.O.W. content generated in document\";\r\nexport const noTableMsg = \"No table is selected in the document\";\r\nexport const changeRequestMsg = \"Requested changes have been made in the document\";\r\nexport const botUrl =\r\n  \"https://148a369decc3eeda85b913c1e80b9a.da.environment.api.powerplatform.com/powervirtualagents/botsbyschema/cra27_agent123/directline/token?api-version=2022-03-01-preview\";\r\nexport const botTemplate = `<div class=\"bot-wrapper\">\r\n  <img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviWord\r\n</div>\r\n<div class=\"message bot\">`;\r\nexport const userTemplate = `<div class=\"user-wrapper\">You</div><div class=\"message user\">`;\r\n","/* eslint-disable prettier/prettier */\r\n/* eslint-disable no-undef */\r\nimport { welcomeMsg, tableMsg, sowMsg, noTableMsg, changeRequestMsg, botTemplate, botUrl, userTemplate } from \"../Constants.js\";\r\nlet speechFlag = false;\r\nlet popup = null;\r\n\r\nOffice.onReady(async function (info) {\r\n  displayStartingMessage(welcomeMsg);\r\n  let directLine1 = await initializeDirectLine();\r\n  if (info.host === Office.HostType.Word) {\r\n    document.getElementById(\"sendButton\").onclick = async function () {\r\n      const question = document.getElementById(\"userInput\").value;\r\n      if (question) {\r\n        //document.getElementById(\"headerId\").style.display = \"none\";\r\n        displayChatMessage(question, \"\", \"User\", directLine1);\r\n        await getBotResponse(directLine1, question);\r\n      }\r\n    };\r\n\r\n    document.getElementById(\"userInput\").addEventListener(\"keydown\", async function (event) {\r\n      if (event.key === \"Enter\") {\r\n        // Check if Enter key is pressed\r\n        event.preventDefault(); // Prevents the default behavior (like submitting a form)\r\n\r\n        const question = document.getElementById(\"userInput\").value;\r\n        if (question) {\r\n          //document.getElementById(\"headerId\").style.display = \"none\";\r\n          displayChatMessage(question, \"\", \"User\", directLine1);\r\n          await getBotResponse(directLine1, question);\r\n        }\r\n      }\r\n    });\r\n\r\n    // Handle the Insert button click\r\n    document.getElementById(\"insertButton\").onclick = async function () {\r\n      const response = document.getElementById(\"chatWindow\").lastChild\r\n        ? document.getElementById(\"chatWindow\").lastChild.innerText\r\n        : \"\";\r\n      if (response) {\r\n        await insertResponseIntoDocument(response);\r\n      }\r\n    };\r\n\r\n    document.getElementById(\"startSpeechButton\").addEventListener(\"click\", function () {\r\n      // Open a pop-up window to handle the speech\r\n      if (speechFlag) {\r\n        mic.classList.toggle(\"recording\");\r\n        speechFlag = false;\r\n        try {\r\n          popup.close();\r\n        } catch {\r\n          console.log(\"popup closed\");\r\n        }\r\n      } else {\r\n        mic.classList.toggle(\"recording\");\r\n        popup = window.open(\"speech.html\", \"SpeechRecognition\", \"width=1,height=1\");\r\n        speechFlag = true;\r\n        // Listen for messages from the pop-up window\r\n        window.addEventListener(\r\n          \"message\",\r\n          async function eventHandler(event) {\r\n            if (event.origin !== window.location.origin) return; // Security check\r\n\r\n            // Get the recognized text from the pop-up\r\n            transcript = event.data;\r\n\r\n            // Insert recognized text into user input\r\n            console.log(transcript);\r\n            if (transcript === \"NoSpeech\") {\r\n              popup.close();\r\n              speechFlag = false;\r\n              mic.classList.toggle(\"recording\");\r\n              window.removeEventListener(\"message\", eventHandler);\r\n            } else {\r\n              document.getElementById(\"userInput\").value = transcript;\r\n              var question = document.getElementById(\"userInput\").value;\r\n              if (question) {\r\n                document.getElementById(\"userInput\").value = \"\";\r\n                displayChatMessage(question, \"\", \"User\");\r\n                const micButton = document.getElementById(\"startSpeechButton\"); //disable mic\r\n                micButton.disabled = true;\r\n                await getBotResponse(directLine1, question);\r\n              }\r\n              popup.close();\r\n\r\n              mic.classList.toggle(\"recording\");\r\n              window.removeEventListener(\"message\", eventHandler);\r\n            }\r\n          },\r\n          { once: true }\r\n        );\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nfunction displayStartingMessage(starter) {\r\n  chatWindow.innerHTML += `${botTemplate}${starter}</div>`;\r\n}\r\n\r\n// Display user question and bot response in chat window\r\nasync function displayChatMessage(question, response, role, directLine) {\r\n  const chatWindow = document.getElementById(\"chatWindow\");\r\n  console.log(\"displayfunction called\");\r\n\r\n  // Check if response is valid and if attachments exist\r\n  // eslint-disable-next-line no-constant-condition\r\n  if (response && response.attachments && response.attachments.length > 0) {\r\n    response.attachments.forEach((attachment) => {\r\n      // Check if attachment content has 'buttons' and 'signin' type\r\n      if (attachment.content && attachment.content.buttons && attachment.content.buttons.length > 0) {\r\n        attachment.content.buttons.forEach((button) => {\r\n          if (button.type === \"signin\") {\r\n            // Create a sign-in button\r\n            const signinButton = document.createElement(\"button\");\r\n            signinButton.innerText = button.title || \"Sign In\"; // Default title to \"Sign In\"\r\n            signinButton.classList.add(\"ms-Button\", \"ms-Button--primary\");\r\n\r\n            // Open the sign-in URL when the button is clicked\r\n            signinButton.onclick = () => {\r\n              window.open(button.value, \"_blank\"); // Open the sign-in URL in a new tab\r\n            };\r\n\r\n            // Display the bot's message\r\n            chatWindow.innerHTML += `${botTemplate}${attachment.content.text}</div>`;\r\n            chatWindow.appendChild(signinButton); // Add the button after the message\r\n          }\r\n        });\r\n      }\r\n    });\r\n  } else {\r\n    // Regular message display if no attachments\r\n    if (role === \"bot\") {\r\n      if (response.speak === \"Generate\") {\r\n        insertResponseIntoDocument(response.text);\r\n        chatWindow.innerHTML += `${botTemplate}${sowMsg}</div>`;\r\n        if (speechFlag) {\r\n          ensureVoicesLoaded(() => {\r\n            speakText(sowMsg);\r\n          });\r\n\r\n          //speechFlag = false;\r\n        }\r\n      } else if (response.speak === \"Table\") {\r\n        insertResponseIntoDocumentAtCursor(response.text, \"end\");\r\n        chatWindow.innerHTML += `${botTemplate}${tableMsg}</div>`;\r\n        if (speechFlag) {\r\n          ensureVoicesLoaded(() => {\r\n            speakText(tableMsg);\r\n          });\r\n\r\n          //speechFlag = false;\r\n        }\r\n      } else if (response.speak === \"TableReplace\") {\r\n        let statusflag = false;\r\n        statusflag = await insertResponseIntoDocumentAtCursor(response.text, \"replace\");\r\n        console.log(statusflag);\r\n        if (statusflag) {\r\n          chatWindow.innerHTML += `${botTemplate}${tableMsg}</div>`;\r\n          if (speechFlag) {\r\n            ensureVoicesLoaded(() => {\r\n              speakText(tableMsg);\r\n            });\r\n\r\n            //speechFlag = false;\r\n          }\r\n        } else {\r\n          chatWindow.innerHTML += `${botTemplate}${noTableMsg}</div>`;\r\n          if (speechFlag) {\r\n            ensureVoicesLoaded(() => {\r\n              speakText(noTableMsg);\r\n            });\r\n\r\n            //speechFlag = false;\r\n          }\r\n        }\r\n      } else if (response.speak === \"Replace\") {\r\n        splitText = response.text;\r\n        textArray = splitText.split(\"|\");\r\n        replaceText(textArray[0], textArray[1]);\r\n        chatWindow.innerHTML += `${botTemplate}Replaced ${textArray[0]} with ${textArray[1]} </div>`;\r\n        if (speechFlag) {\r\n          ensureVoicesLoaded(() => {\r\n            speakText(`Replaced ${textArray[0]} with ${textArray[1]}`);\r\n          });\r\n\r\n          //speechFlag = false;\r\n        }\r\n      } else if (response.speak === \"Selected\") {\r\n        if (response.text === \"Table\") {\r\n          console.log(\"fetching selected table\");\r\n          getSelectedTable(directLine);\r\n        } else {\r\n          console.log(\"fetching selected data\");\r\n          getSelectedText(directLine);\r\n        }\r\n      } else if (response.speak === \"paragraph\") {\r\n        setSelectedText(response.text);\r\n        chatWindow.innerHTML += `${botTemplate}${changeRequestMsg}</div>`;\r\n        if (speechFlag) {\r\n          ensureVoicesLoaded(() => {\r\n            speakText(changeRequestMsg);\r\n          });\r\n\r\n          //speechFlag = false;\r\n        }\r\n      } else if (response.speak === \"interim\") {\r\n        chatWindow.innerHTML += `${botTemplate}${response.text}</div>`;\r\n        if (speechFlag) {\r\n          ensureVoicesLoaded(async () => {\r\n            await speakText(response.text);\r\n            speechFlag = true;\r\n          });\r\n        }\r\n      } else if (response.speak === \"interimFinal\") {\r\n        chatWindow.innerHTML += `${botTemplate}${response.text}</div>`;\r\n        if (speechFlag) {\r\n          ensureVoicesLoaded(async () => {\r\n            speakText(response.text);\r\n          });\r\n        }\r\n      } else if (response.text) {\r\n        chatWindow.innerHTML += `${botTemplate}${response.text}</div>`;\r\n        document.getElementById(\"insertButton\").style.display = \"block\";\r\n        if (speechFlag) {\r\n          console.log(\"speaking bot message\");\r\n          ensureVoicesLoaded(() => {\r\n            speakText(response.text);\r\n          });\r\n\r\n          //speechFlag = false;\r\n        }\r\n      }\r\n    } else {\r\n      if (question) {\r\n        document.getElementById(\"insertButton\").style.display = \"none\";\r\n        chatWindow.innerHTML += `${userTemplate}${question}</div>`;\r\n      }\r\n    }\r\n  }\r\n  scrollToBottom();\r\n  // Clear the input field\r\n  document.getElementById(\"userInput\").value = \"\";\r\n}\r\n\r\n// Function to insert the response into the Word document\r\nasync function insertResponseIntoDocument(response) {\r\n  await Word.run(async (context) => {\r\n    const body = context.document.body;\r\n    body.insertHtml(response, Word.InsertLocation.end);\r\n    await context.sync();\r\n  });\r\n}\r\n\r\nasync function insertResponseIntoDocumentAtCursor(response, insertAt) {\r\n  if (insertAt === \"end\") {\r\n    console.log(\"end of doc table\");\r\n    return await Word.run(async (context) => {\r\n      const body = context.document.body;\r\n      body.insertHtml(response, Word.InsertLocation.end);\r\n      await context.sync();\r\n      return true;\r\n    });\r\n  } else {\r\n    return await Word.run(async (context) => {\r\n      const selection = context.document.getSelection();\r\n      selection.load(\"parentTable\");\r\n      await context.sync();\r\n\r\n      if (!selection.parentTable) {\r\n        console.log(\"❌ No table selected.\");\r\n        return false;\r\n      }\r\n\r\n      const table = selection.parentTable;\r\n      const tableRange = table.getRange(Word.RangeLocation.entire); // Capture range before deletion\r\n      tableRange.load();\r\n      await context.sync();\r\n\r\n      console.log(\"Table found. Deleting...\");\r\n\r\n      // Insert a placeholder before deleting (to keep a valid reference)\r\n      const placeholder = tableRange.insertText(\" \", Word.InsertLocation.before);\r\n      placeholder.load(\"text, address\"); // Load placeholder info\r\n      await context.sync();\r\n\r\n      table.delete(); // Delete the table\r\n      await context.sync();\r\n      console.log(\"Table deleted.\");\r\n\r\n      console.log(\"Inserting new table...\");\r\n      placeholder.insertHtml(response, Word.InsertLocation.replace); // Insert new content\r\n      await context.sync();\r\n\r\n      console.log(\"New table inserted.\");\r\n      return true;\r\n    });\r\n  }\r\n}\r\n\r\nconst initializeDirectLine = async function () {\r\n  try {\r\n    const response = await fetch(botUrl);\r\n    const data = await response.json();\r\n\r\n    const directLine = new window.DirectLine.DirectLine({ token: data.token });\r\n\r\n    if (!directLine || !directLine.activity$) {\r\n      throw new Error(\"DirectLine instance failed to initialize\");\r\n    }\r\n\r\n    directLine\r\n      .postActivity({\r\n        from: { id: \"10\", name: \"User\" },\r\n        type: \"message\",\r\n        text: \"Hi\",\r\n      })\r\n      .subscribe(\r\n        (id) => console.log(\"Message sent with ID:\", id),\r\n        (error) => console.error(\"Error sending message:\", error)\r\n      );\r\n\r\n    directLine.activity$.subscribe((activity) => {\r\n      console.log(\"Testing activity on send: \", activity);\r\n      console.log(\"Role\", activity.from.role);\r\n\r\n      if (activity.type === \"message\" && activity.from.id !== \"10\" && !activity.recipient) {\r\n        console.log(\"Bot Response: \", activity.text);\r\n        try {\r\n          document.getElementById(\"loader-container\").remove();\r\n          document.getElementById(\"loader\").remove();\r\n        } catch {\r\n          console.log(\"could not find the element\");\r\n        }\r\n        displayChatMessage(false, activity, activity.from.role, directLine);\r\n      }\r\n    });\r\n    return directLine;\r\n  } catch (error) {\r\n    console.error(\"Error initializing DirectLine:\", error);\r\n  }\r\n};\r\n\r\nconst getBotResponse = async function (directLine, question) {\r\n  // call loading function\r\n  console.log(\"Calling loading function\");\r\n  displayLoading();\r\n  console.log(\"User:\", question);\r\n  directLine\r\n    .postActivity({\r\n      from: { id: \"10\", name: \"User\" },\r\n      type: \"message\",\r\n      text: question,\r\n    })\r\n    .subscribe(\r\n      // calls the subscription already created in InitializeDirectline method\r\n      (id) => console.log(\"Message sent with ID:\", id),\r\n      (error) => console.error(\"Error sending message:\", error)\r\n    );\r\n};\r\nfunction scrollToBottom() {\r\n  const chatWindow = document.getElementById(\"chatWindow\");\r\n  setTimeout(() => {\r\n    chatWindow.scrollTop = chatWindow.scrollHeight;\r\n  }, 100); // Timeout ensures scroll happens after the new message is rendered\r\n}\r\n\r\nasync function replaceText(oldText, newText) {\r\n  await Word.run(async (context) => {\r\n    let results = context.document.body.search(oldText, { matchCase: false });\r\n    results.load(\"items\");\r\n    await context.sync();\r\n    console.log(\"Results found:\", results.items.length);\r\n    for (let i = results.items.length - 1; i >= 0; i--) {\r\n      let item = results.items[i];\r\n      console.log(\"Replacing:\", item.text);\r\n      item.insertText(newText, Word.InsertLocation.replace);\r\n    }\r\n    await context.sync();\r\n    console.log(\"ll instances replaced successfully.\");\r\n  });\r\n}\r\n\r\nasync function getSelectedText(directLine) {\r\n  await Word.run(async (context) => {\r\n    let range = context.document.getSelection();\r\n    range.load(\"text\");\r\n    await context.sync();\r\n    SelText = range.text;\r\n    await getBotResponse(directLine, SelText);\r\n  });\r\n}\r\n\r\nasync function getSelectedTable(directLine) {\r\n  await Word.run(async (context) => {\r\n    const selection = context.document.getSelection();\r\n    selection.load(\"parentTable\");\r\n    await context.sync();\r\n    if (selection.parentTable) {\r\n      const table = selection.parentTable;\r\n      table.load(\"values\"); // Get table content as a 2D array\r\n\r\n      await context.sync();\r\n\r\n      const tableValues = table.values; // Array of rows with cell content\r\n\r\n      let plainTextTable = \"\";\r\n      tableValues.forEach((row) => {\r\n        plainTextTable += row.join(\" | \") + \"\\n\"; // Join cells with \"|\"\r\n      });\r\n\r\n      console.log(plainTextTable);\r\n      await getBotResponse(directLine, plainTextTable);\r\n      // Output the extracted table as plain text\r\n    } else {\r\n      console.log(\"No table selected by user.\");\r\n    }\r\n  });\r\n}\r\n\r\nasync function setSelectedText(response) {\r\n  await Word.run(async (context) => {\r\n    const selection = context.document.getSelection();\r\n    selection.insertText(response, Word.InsertLocation.replace);\r\n    await context.sync();\r\n  });\r\n}\r\n\r\nasync function speakText(text) {\r\n  console.log(\"Testing Text to Speech\");\r\n\r\n  let voices = window.speechSynthesis.getVoices();\r\n  console.log(\"Voices:\", voices);\r\n\r\n  let femaleVoice = voices.find(\r\n    (voice) =>\r\n      voice.name.includes(\"Female\") ||\r\n      voice.name.includes(\"Google UK English Female\") ||\r\n      voice.name.includes(\"Microsoft Zira\") ||\r\n      voice.name.includes(\"Samantha\")\r\n  );\r\n\r\n  console.log(\"Set voice:\", femaleVoice);\r\n\r\n  const speech = new SpeechSynthesisUtterance(text);\r\n\r\n  if (femaleVoice) {\r\n    speech.voice = femaleVoice;\r\n  } else {\r\n    console.warn(\"Female voice not found. Using default voice.\");\r\n  }\r\n\r\n  return new Promise((resolve) => {\r\n    speech.onend = () => {\r\n      console.log(\"Speech has finished.\");\r\n      speechFlag = false;\r\n      // enable mic\r\n      const micButton = document.getElementById(\"startSpeechButton\"); //disable mic\r\n      micButton.disabled = false;\r\n      console.log(\"mic enabled\");\r\n      resolve(true);\r\n    };\r\n\r\n    speech.onerror = (event) => {\r\n      console.error(\"Speech error:\", event.error);\r\n      speechFlag = false;\r\n      // enable mic\r\n      const micButton = document.getElementById(\"startSpeechButton\"); //disable mic\r\n      micButton.disabled = false;\r\n      console.log(\"mic enabled\");\r\n      resolve(false);\r\n    };\r\n\r\n    window.speechSynthesis.speak(speech);\r\n  });\r\n}\r\n\r\n// Load voices properly before calling the function\r\nfunction ensureVoicesLoaded(callback) {\r\n  let voices = window.speechSynthesis.getVoices();\r\n\r\n  if (voices.length > 0) {\r\n    callback();\r\n  } else {\r\n    window.speechSynthesis.onvoiceschanged = callback;\r\n  }\r\n}\r\n\r\nfunction displayLoading() {\r\n  let loadingElement = document.getElementById(\"chatWindow\");\r\n  let loadingDots = [\".\", \"..\", \"...\"];\r\n  let dotIndex = 1;\r\n  loadingElement.innerHTML += `<div id=\"loader-container\" class=\"bot-wrapper\"><img width=20 height=20 src=\"../../assets/copilot.png\"/> NoviPilot</div><div id = \"loader\" class=\"message bot\">.</div>`;\r\n\r\n  let loader = document.getElementById(\"loader\");\r\n  setInterval(() => {\r\n    loader.innerText = loadingDots[dotIndex];\r\n    dotIndex = (dotIndex + 1) % loadingDots.length;\r\n  }, 500);\r\n}\r\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/copilot.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Word Chatbot Add-in</title> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/botframework-directlinejs@latest/dist/directline.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header class=\\\"ms-welcome__header\\\"> <div id=\\\"headerId\\\"> <img class=\\\"header-img\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Word Chatbot\\\" title=\\\"Word Chatbot\\\"/> <h3>Smart chat for smarter documents!</h3> </div> </header> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\"> <div class=\\\"chat-window-main\\\"> <div class=\\\"chat-container\\\"> <div id=\\\"chatWindow\\\" class=\\\"chat-window\\\"></div> </div> </div> <div class=\\\"input-container\\\"> <input type=\\\"text\\\" id=\\\"userInput\\\" class=\\\"input-field\\\" placeholder=\\\"Ask a question\\\"/> <button id=\\\"sendButton\\\" class=\\\"icon-button\\\"> <svg aria-hidden=\\\"true\\\" height=\\\"2em\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"2em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M2.18 2.11a.5.5 0 0 1 .54-.06l15 7.5a.5.5 0 0 1 0 .9l-15 7.5a.5.5 0 0 1-.7-.58L3.98 10 2.02 2.63a.5.5 0 0 1 .16-.52Zm2.7 8.39-1.61 6.06L16.38 10 3.27 3.44 4.88 9.5h6.62a.5.5 0 1 1 0 1H4.88Z\\\" fill=\\\"#000000\\\"></path></svg> </button> <button id=\\\"startSpeechButton\\\" class=\\\"icon-button\\\"> <svg id=\\\"mic\\\" class=\\\"mic\\\" width=\\\"30px\\\" height=\\\"30px\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"> <path d=\\\"M20 12V13C20 17.4183 16.4183 21 12 21C7.58172 21 4 17.4183 4 13V12M12 17C9.79086 17 8 15.2091 8 13V7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7V13C16 15.2091 14.2091 17 12 17Z\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/> </svg> </button> </div> <button id=\\\"insertButton\\\" class=\\\"ms-Button ms-Button--hero\\\" style=\\\"display:none\\\">Insert</button> </main> <\" + \"script type=\\\"module\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","tableMsg","sowMsg","noTableMsg","changeRequestMsg","botTemplate","_regeneratorRuntime","t","r","n","defineProperty","value","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","v","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","speechFlag","popup","displayChatMessage","_x4","_x5","_x6","_x7","_displayChatMessage","_callee10","question","response","role","directLine","chatWindow","statusflag","_context10","getElementById","console","log","attachments","attachment","content","buttons","button","signinButton","createElement","innerText","title","classList","add","onclick","open","innerHTML","concat","text","appendChild","speak","insertResponseIntoDocument","ensureVoicesLoaded","speakText","insertResponseIntoDocumentAtCursor","splitText","textArray","split","replaceText","getSelectedTable","getSelectedText","setSelectedText","_callee8","_context8","_callee9","_context9","style","display","scrollToBottom","_x8","_insertResponseIntoDocument","_callee12","_context12","Word","run","_ref9","_callee11","context","_context11","body","insertHtml","InsertLocation","end","sync","_x19","_x9","_x10","_insertResponseIntoDocumentAtCursor","_callee15","insertAt","_context15","_ref10","_callee13","_context13","_x20","_ref11","_callee14","selection","table","tableRange","placeholder","_context14","getSelection","load","parentTable","getRange","RangeLocation","entire","insertText","before","delete","_x21","Office","onReady","_ref","_callee5","info","directLine1","_context5","initializeDirectLine","host","HostType","_callee","_context","getBotResponse","addEventListener","_ref3","_callee2","event","_context2","key","preventDefault","_x2","_callee3","_context3","lastChild","mic","toggle","close","_unused","_eventHandler","_callee4","_context4","origin","transcript","data","removeEventListener","eventHandler","disabled","_x3","once","_x","_ref5","_callee6","_context6","fetch","json","DirectLine","token","activity$","postActivity","from","id","subscribe","error","activity","recipient","remove","_unused2","t0","_ref6","_callee7","_context7","displayLoading","_x11","_x12","setTimeout","scrollTop","scrollHeight","_x13","_x14","_replaceText","_callee17","oldText","newText","_context17","_ref12","_callee16","results","item","_context16","search","matchCase","items","_x22","_x15","_getSelectedText","_callee19","_context19","_ref13","_callee18","range","_context18","SelText","_x23","_x16","_getSelectedTable","_callee21","_context21","_ref14","_callee20","tableValues","plainTextTable","_context20","row","join","_x24","_x17","_setSelectedText","_callee23","_context23","_ref15","_callee22","_context22","_x25","_x18","_speakText","_callee24","voices","femaleVoice","speech","_context24","speechSynthesis","getVoices","find","voice","includes","SpeechSynthesisUtterance","warn","onend","onerror","callback","onvoiceschanged","loadingElement","loadingDots","dotIndex","loader","setInterval","URL"],"sourceRoot":""}